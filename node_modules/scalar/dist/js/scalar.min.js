!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("scalar",[],n):"object"==typeof exports?exports.scalar=n():e.scalar=n()}(self,(function(){return(()=>{"use strict";var e={d:(n,t)=>{for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function t(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,n){var t=e.headers,r=e.data,a=e.queryString,o=e.url,i=new XMLHttpRequest;for(var u in r="application/json"===t["Content-Type"]?JSON.stringify(r):function(e){var n=new FormData;for(var t in e)n.append(t,e[t]);return n}(r),o=function(e,n){for(var t in n){var r="/{"+t+"}";-1!==e.indexOf(r)&&(e=e.replace(r,"/"+n[t]),delete n[t])}return e.replace(/\/\{(\w+)\}/gi,"")}(o,a)+function(e,n){var t=[];for(var r in n)t.push(encodeURIComponent(r)+"="+encodeURIComponent(n[r]));return t.length?e+t.join("&"):""}(-1===o.indexOf("?")?"?":"&",a),i.open(e.method,o,!0),t)i.setRequestHeader(u,t[u]);i.send(r),i.onreadystatechange=function(){if(4===i.readyState){var t=i.getResponseHeader("Content-Type"),r=i.responseURL,a=i.responseText;t&&(-1!==t.indexOf("application/json")?a=JSON.parse(a):/(application|text)\/xml/.test(t)&&(a=i.responseXML)),n({response:a,url:r,status:i.status,redirect:e.redirect&&r!==o})}}}function a(e,n,t){var r=e.status,a=e.response;if(e.redirect)return window.location=e.url;r>399?t(a,r):n(a,r)}function o(e,n,t,o){return e.method=n,e.data=t,e.queryString=o,new Promise((function(n,t){if(Worker){var o=new Blob(["self.onmessage=function(e){("+r+")(e.data,self.postMessage)}"]),i=new Worker(window.URL.createObjectURL(o));i.postMessage(e),i.onmessage=function(e){return a(e.data,n,t)}}else r(e,(function(e){return a(e,n,t)}))}))}e.r(n),e.d(n,{Component:()=>X,Module:()=>J,Resource:()=>i});var i=function(){function e(n,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=n,this.redirect=!0,this.headers=Object.assign({"X-Requested-With":"XMLHttpRequest"},t||{})}var n,r,a;return n=e,(r=[{key:"get",value:function(e){return o(this,"GET",null,e)}},{key:"post",value:function(e,n){return o(this,"POST",e,n)}},{key:"put",value:function(e,n){return o(this,"PUT",e,n)}},{key:"delete",value:function(e){return o(this,"DELETE",null,e)}},{key:"request",value:function(e,n,t){return o(this,e,n,t)}}])&&t(n.prototype,r),a&&t(n,a),e}();function u(e,n,t,r){var a=e[n[r=r||0]];return e[n[r]]=++r<n.length?u(a||{},n,t,r):t,e}function c(e){return Array.isArray(e)?e.map((function(e){return c(e)})):Object.assign({},e)}function s(e){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}));return Object.defineProperty(e,"uuid",{value:n,configurable:!1,writable:!1}),n}function f(e,n,t){e.value=n.length?u(e.value||{},n,t):t}var l=!1;function p(e,n,t){t=t||!0;var r=function(r){var a=n[r];if(t&&a instanceof Function){var o=!e.eventListenerList;o&&(e.eventListenerList=[]),a.uuid||(o=s(a)),!o&&e.eventListenerList.find((function(e){return e.fn.uuid===a.uuid}))||function(e,n,t){var r=e.length-1,a=!1,o=!0;if(0===e.indexOf("_")){var i=t;(t=function(e){return!0!==i.call(n,e)&&e.preventDefault()}).uuid=i.uuid,o=!1,e=e.substring(1)}e.lastIndexOf("_")===r&&(a=!0,e=e.substring(0,r));var u=l?{passive:o,capture:a}:a;n.addEventListener(e,t,u),n.eventListenerList.push({name:e,fn:t,opt:u})}(r,e,a)}else for(var i,u=e.querySelectorAll(r),c=0;i=u[c];c++)p(i,a)};for(var a in n)r(a)}document.createElement("b").addEventListener("load",null,Object.defineProperty({},"passive",{get:function(){l=!0}}));var d={};function v(e,n){var t=e.uuid;return t||(t=s(e)),d[t]=n,t}function h(e){var n=e.uuid;return n||(n=v(e,{})),d[n]}function y(e,n,t){if(t.constructor===Object)for(var r in t)y(e[n],r,t[r]);else e[n]!==t&&(e[n]=t)}function m(e,n){for(var t,r=0;t=n[r];r++){if(!e[t])return!1;e=e[t]}return e}function b(e,n,t){var r=n.$element,a=n.name,o=r.eventListenerList,i=e.parent;if(t=n.exp?Function("p","return "+n.exp)(e.component):m(t,n.prop),y(n.$attribute,a,t),o&&0===a.indexOf("class")||"id"===a){for(;o.length;){var u=o.shift();r.removeEventListener(u.name,u.fn,u.opt)}p(i.$node,i.events)}}function g(e,n){var t=n.getAttribute("data-bind");if(t&&"SCRIPT"!==n.tagName){var r=e.parent.properties[t.split(".")[0]].nodes,a=r.find((function(e){return e.$node===n}));r.splice(r.indexOf(a),1)}}function x(e,n){if(3!==n.nodeType){for(var t,r=n.querySelectorAll("[data-bind]"),a=0;t=r[a];a++)g(e,t);g(e,n)}}function E(e,n,t,r,a){a=a||0,r?t?t.nodeType!==r.nodeType||3===t.nodeType&&t.nodeValue!==r.nodeValue||t.tagName!==r.tagName?(n.replaceChild(t,r),x(e,r)):3!==t.nodeType&&(!function(e,n,t,r){for(var a=r.length-1;a>=0;a--){var o=r[a],i=o.name,u=o.value,c=t.getNamedItem(i);c&&c.value===u?t.removeNamedItem(i):("data-bind"===i&&g(e,n),c||n.removeAttribute(i))}for(var s=0;s<t.length;s++){var f=t[s],l=f.name,p=f.value;"selected"===l&&(n.parentNode.value=n.value),n.setAttribute(l,p)}}(e,n.childNodes[a],t.attributes,r.attributes),w(e,r,t)):(n.removeChild(r),x(e,r)):n.appendChild(t)}function w(e,n,t){for(var r=Array.from(n.childNodes),a=Array.from(t.childNodes),o=0;o<a.length||o<r.length;o++)E(e,n,a[o],r[o],o)}var T={};function L(e){return e.replace(/\s+/g," ").replace(/<\s/g,"<").replace(/\s?\/?\s?>/g,">")}function O(e,n,t){return{property:e,$node:n,tpl:L(t.innerHTML),base:L(n.innerHTML.replace(t.outerHTML,""))}}function j(e){for(var n,t=[],r=[],a=/\$\{data(?:\.)?([\w\.]*)\}/g;null!==(n=a.exec(e.tpl));)t.push(n[1]);if(!t.length)return r;a=new RegExp(e.tpl.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\$\\\{data(\\\.)?(\w|(\\\.))*\\\}/g,"(.*?)").replace(/\\\$\\\{[^\}]*\}/g,".*?").replace(/ /g,"\\s?").replace("&","[?&]amp;"),"g");for(var o=function(){var e={};t.forEach((function(t,r){f(e,t?t.split("."):t,n[r+1])})),r.push(e.value)};null!==(n=a.exec(e.base));)o();return r}function k(e){var n=e.nodeName;return"INPUT"===n||"TEXTAREA"===n||"SELECT"===n}function P(e,n,t){t=t||"value";var r=e.type;"checkbox"===r||"radio"===r?(t="checked","radio"===r&&(n=e.value===n)):"file"===r&&(t="files"),e[t]!==n&&(e[t]=n,e.dispatchEvent(new Event("mutate")))}function S(e){return"radio"===e.type?e.checked?e.value:null:"file"===e.type&&e.files?e.files:"checkbox"===e.type?e.checked:e.value||null}function A(e,n,t){var r=c(e.value);f(e,n,t),t=e.value,e.nodes.forEach((function(e){$(e,r,t)})),e.attributes.forEach((function(n){b(e,n,t)}))}function $(e,n,t){var r=e.$node,a=e.complexType,o=k(r)?"value":"innerHTML";e.prop.forEach((function(e){t=t[e],n=n[e]})),t!==n&&(a&&t?function(e,n){var t=e.$node,r=e.tpl,a=e.property,o=document.createElement("template");T[r]||(T[r]=Function("data,index","return `"+r+"`")),o.innerHTML=Array.isArray(n)?n.map(T[r]).join(""):T[r](n),w(a,t,o.content),t.dispatchEvent(new Event("mutate")),F(a.component,a.parent,t)}(a,t):P(r,t,o))}var N=function e(n,t){return{set:function(e,r,a){var o=c(t=t||e);return a instanceof Promise?a.then((function(a){if(Reflect.set(e,r,a))return C(n,t,o)})):Reflect.set(e,r,a)?C(n,t,o):void 0},get:function(r,a,o){var i=Reflect.get(r,a,o);if(i){var u=i.constructor;if(t=t||r,u===Function)return new Proxy(i.bind(r),function(e,n){return{apply:function(t,r,a){var o=c(n),i=Reflect.apply(t,r,a);return C(e,n,o),i}}}(n,t));if(u===Object||u===Array)return new Proxy(i,e(n,t))}return i}}};function R(e,n,t){return e.value=n,e.nodes.forEach((function(e){$(e,t,n)})),e.attributes.forEach((function(t){b(e,t,n)})),!0}function M(e,n,t){var r=e.parent.module.components;if(n.parentNode){var a=n.parentNode;if(a.dataset&&a.dataset.component){var o=a.dataset.component;r[o][t]&&function(e,n,t){var r=(e=h(e)).properties[t],a=Object.assign({},n.parent.events);for(var o in r.over.push(n),n.over.push(r),a)a[o]instanceof Function&&delete a[o];Object.assign(e.events,a)}(r[o],e,t)}M(e,n.parentNode,t)}}function C(e,n,t){return e.over.forEach((function(e){e.value=n})),n instanceof Promise?n.then((function(n){return R(e,n,t)})):R(e,n,t)}function q(e,n,t){e.nodes.find((function(e){return e.$node===n}))||e.nodes.push(function(e,n,t){var r=e.value,a=null;if(r instanceof Object&&(r=function(e,n){for(var t,r=0;t=n[r];r++){if(!e[t])return"";e=e[t]}return e}(r,t)),k(n)){var o=S(n);n.addEventListener("keyup",(function(n){var r=n.target;A(e,t,r.value),r.focus()})),n.addEventListener("change",(function(n){A(e,t,S(n.target))})),null===o?P(n,r):r=o}else if("SCRIPT"===n.tagName&&"text/template"===n.type)r=j(a=O(e,n.parentNode,n));else if(n.innerHTML){var i=n.querySelector('script[type="text/template"]');r=n.innerHTML,i&&(r=j(a=O(e,n,i)))}else P(n,r,"innerHTML");return f(e,t,r),{prop:t,$node:n,complexType:a}}(e,n,t))}function H(e,n,t,r,a){e.attributes.push(function(e,n,t,r,a){var o=n.split("."),i=e.value,u=t;n=o.pop(),o.forEach((function(e){u=u[e]}));var c={name:n,$attribute:u,$element:t,prop:r,exp:a};return a||m(i,r)?b(e,c,i):f(e,r,u[n]),c}(e,n,t,r,a))}function I(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,n){var t=function(e,n){var t=h(e),r={component:e,parent:t,value:"",nodes:[],attributes:[],over:[]};return M(r,t.$node,n),r}(e,n);return Object.defineProperty(e,n,{get:function(){return(n=(e=t).value)instanceof Object?(e.observable!==n&&(e.proxy=new Proxy(n,N(e)),e.observable=n),e.proxy):n;var e,n},set:function(e){return C(t,e,c(t.value))}}),t}function F(e,n,t){var r=Array.from(t.querySelectorAll("[data-bind]")),a=Array.from(t.querySelectorAll("[data-attr]"));t.dataset.bind&&r.push(t),t.dataset.attr&&a.push(t),r.forEach((function(t){!function(e,n,t){var r=t.dataset.bind,a=n.properties,o=r.split(".");a[r=o.shift()]||(a[r]=U(e,r)),q(a[r],t,o)}(e,n,t)})),a.forEach((function(t){!function(e,n,t){t.dataset.attr.split(";").forEach((function(r){var a=r.indexOf(":"),o=[],i=r.substr(a+1).trim();i.replace(/'[^']*'/g,"").match(/\w[\w\._]+/g).forEach((function(t){var r=t.split("."),a=r.shift(),u=n.properties;u[a]||(u[a]=U(e,a)),i=i!==t?i.replace(t,"p."+t.replace(/\.([\w_]+)/g,"['$1']")):null,o.push({props:r,value:u[a]})})),o.forEach((function(e){H(e.value,r.substr(0,a).trim(),t,e.props,i)}))}))}(e,n,t)})),p(t,n.events)}function _(e,n,t){var r={$node:e,module:t,properties:{}},a=n.prototype instanceof X,o=a?new n:new X;return v(o,r),r.events=a?o.listen&&o.listen():n(o),F(o,r,e),e.dispatchEvent(new Event("mount")),o}var X=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,r;return n=e,(t=[{key:"inject",value:function(e){return h(this).module.inject(e)}},{key:"compose",value:function(e,n){return _(e,n,h(this).module)}},{key:"getIndex",value:function(e){var n=h(this).$node,t=e.target;do{var r=t.dataset.key;if(r)return r;t=t.parentNode}while(t!==n)}}])&&I(n.prototype,t),r&&I(n,r),e}();function D(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function W(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function e(){D(this,e);var n={classes:{},instances:{},components:{},inject:function(e){var t=n.classes,r=n.instances,a=e.uuid;return t[a]&&((e=new t[a](n.inject)).uuid=a,r[a]=e,delete t[a]),r[a]}};v(this,n);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];r.forEach((function(e){e.uuid||(n.classes[s(e)]=e)}))}var n,t,r;return n=e,(t=[{key:"compose",value:function(e,n){for(var t,r=document.querySelectorAll(e),a=0;t=r[a];a++){var o=_(t,n,h(this));h(this).components[o.uuid]=o,t.dataset.component=o.uuid}return this}},{key:"bind",value:function(e,n){return h(this).classes[e.uuid]=n,this}}])&&W(n.prototype,t),r&&W(n,r),e}();return n})()}));
//# sourceMappingURL=scalar.min.js.map